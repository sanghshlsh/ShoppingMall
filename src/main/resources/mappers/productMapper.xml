<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="p.r.o">
	
	<insert id="insert">
			insert into product (productNo, productName, productPrice, productDiscountRate, productSet, isDelete, sellStatus, categoryNo)
		values (#{productNo}, #{productName}, #{productPrice}, #{productDiscountRate}, #{productSet}, #{isDelete}, #{sellStatus}, #{categoryNo})
	</insert>
	<select id="getProductNo" resultType="Integer">
	<![CDATA[select NVL2(max(productNo), max(productNo)+1, 1) from product]]>
	</select>
	<select id="categoryList" resultType="CategoryDTO">
			<![CDATA[select * from category where categoryNoRef is null]]>
	</select>
	
	<select id="categoryList2" resultType="CategoryDTO">
			<![CDATA[select * from category where categoryNoRef = #{categoryNoRef}]]>
	</select>

	<insert id="addAttach">
			<![CDATA[insert into productAttach (attachNo, fullName, productNo) values ((select NVL2(max(attachNo), max(attachNo)+1, 1) from productAttach), #{fullName}, #{productNo})]]>
	</insert>

	<insert id="insertProductOption">
			<![CDATA[insert into productOption (productOptionNo, productColor, productSize, productQuantity, productNo) values ((select NVL2(max(productOptionNo), max(productOptionNo)+1, 1) from productOption) , #{productColor}, #{productSize}, #{productQuantity}, #{productNo})]]>
	
	</insert>
	<select id="productList" resultType="ProductDTO">
			<![CDATA[select * from product]]>
	</select>
	<select id="getCategoryName" resultType="String">
		<![CDATA[select categoryName from category where categoryNo = #{categoryNo}]]>
	</select>
	<select id="updateUI" resultType="ProductDTO">
		<![CDATA[select * from product where productNo = #{productNo}]]>
	</select>
	<select id="getProductOptionList" resultType="ProductOptionDTO">
		<![CDATA[select * from productOption where productNo = #{productNo}]]>
	</select>
	<select id="getAttach" resultType="string">
		<![CDATA[select fullName from productAttach where productNo = #{productNo} order by attachRegDate asc]]>
	</select>
</mapper>